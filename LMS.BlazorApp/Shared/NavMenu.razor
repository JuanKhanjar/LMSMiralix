@using Microsoft.AspNetCore.Components;
@using Microsoft.AspNetCore.Http;
@inject IHttpContextAccessor HttpContextAccessor
@inject NavigationManager NavigationManager
<nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">
            <img src="/image/logo.png"
                 alt="Bootstrap"
                 width="123"
                 height="40" />
        </a>
        <button class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarNav"
                aria-controls="navbarNav"
                aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item p-0">
                    <NavLink class="nav-link" aria-current="page" href="/customer/1" Match=@NavLinkMatch.All>
                        <i class="bi bi-book icon-styled"></i> 
                        Sager
                    </NavLink>
                </li>
                <li class="nav-item p-0">
                    <NavLink class="nav-link" href="/customer/2" Match=@NavLinkMatch.All>
                        <i class="bi bi-box icon-styled"></i> 
                        Din løsning
                    </NavLink>
                </li>
                <li class="nav-item p-0">
                    <NavLink class="nav-link" href="/customer/3" Match=@NavLinkMatch.All>
                        <i class="bi bi-key-fill rotate-icon icon-styled "></i> 
                        Licenser
                    </NavLink>
                </li>
            </ul>
            <ul class="navbar-nav d-flex align-items-center">
                <AuthorizeView>
                    <Authorized>
                        <li class="nav-item p-0">
                            <span class="nav-link">
                                <span class="p-2 d-flex align-items-center">
                                    <span class="p-2 d-flex align-items-center"> Miralix A/S </span>
                                </span>
                            </span>
                        </li>
                        <li class="nav-item p-0">
                            <a href="Identity/Account/Logout" title="@context.User.Identity?.Name!">
                                <span class="material-symbols-outlined">Logout</span>
                            </a>
                        </li>
                    </Authorized>
                    <NotAuthorized>
                        <li class="nav-item p-0">
                            <span class="nav-link">
                                <span class="p-2 d-flex align-items-center">
                                    <span class="p-2 d-flex align-items-center"> Miralix A/S </span>
                                </span>
                            </span>
                        </li>
                        <li class="nav-item p-0">
                            <NavLink class="nav-link" href="Identity/Account/Login">
                                <span class="p-2 d-flex align-items-center" title="Log In Here">
                                    <i class="material-symbols-outlined">Login</i>
                                </span>
                            </NavLink>
                        </li>
                    </NotAuthorized>
                </AuthorizeView>
            </ul>
        </div>
    </div>
</nav>

@* @code {
    protected override void OnInitialized()
    {
        if (HttpContextAccessor.HttpContext.User.Identity.IsAuthenticated)
        {
            // User is authenticated, navigate to the desired page with the username as a parameter
            string username = HttpContextAccessor.HttpContext.User.Identity.Name;
            NavigationManager.NavigateTo($"/customer/{username}");
        }
        else
        {
            // User is not authenticated, navigate to the default customer page
            NavigationManager.NavigateTo($"/Identity/Account/Login");
        }
    }
} *@

